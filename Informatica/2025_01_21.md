SQL


```SQL
CREATE TABLE Dipartimenti (
  id_dipartimento INTEGER AUTO_INCREMENT PRIMARY KEY,
  descrizione VARCHAR(30) NOT NULL,
  sede VARCHAR(30) DEFAULT 'Sede centrale',
  Unique (descrizione)
)
```


```SQL
CREATE TABLE Impiegati(
  id_impiegato INTEGER AUTO_INCREMENT PRIMARY KEY,
  nome VARCHAR(15) NOT NULL,
  cognome VARCHAR(15) NOT NULL,
  residenza VARCHAR(30) DEFAULT 'Nocera terinese',
  stipendio DECIMAL(8,2), 
  id_dipartimento INTEGER,
  CONSTRAINT FK_id_dipartimento 
  	FOREIGN KEY (id_dipartimento)
		REFERENCES Dipartimenti(id_dipartimento)
  			On DELETE set NULL
  			ON UPDATE NO ACTION,
  CHECK (stipendio >= 0)
)
```

```SQL
--DROP TABLE Progetti;

CREATE TABLE IF NOT EXISTS Progetti(
  cod_prog INTEGER AUTO_INCREMENT PRIMARY KEY,
  nome VARCHAR(15) NOT NULL,
  cognome VARCHAR(15) NOT NULL,
  durata INTEGER DEFAULT 0,
  budget DECIMAL(8,2),
  CHECK (durata >= 0)
  );

ALTER TABLE Progetti (
  ADD constraint check_durata CHECK (durata >= 0)
);
```

```SQL
--DROP TABLE demo;


CREATE TABLE Partecipazioni(
  id_impiegato INTEGER,
  cod_prog INTEGER,
  ruolo VARCHAR(10) NOT NULL,
  percentuale INTEGER,
  
  PRIMARY KEY (id_impiegato, cod_prog),
  
  CONSTRAINT FK_id_impiegato FOREIGN KEY (id_dipartimento)
  	REFERENCES Impiegati(id_impiegato),
  
  -- ON DELETE NO ACTION è il default
  
  CONSTRAINT FK_cod_prog FOREIGN KEY (cod_prog)
  	REFERENCES Progetti(cod_prog),
  
  CHECK (percentuale >= 0)
);
```

```SQL
ALTER TABLE Impiegati
	ADD nascita DATE;
```

```SQL
ALTER TABLE Dipartimenti
	ADD Via VARCHAR(10) DEFAULT 'Via Taldei';
    
ALTER TABLE Dipartimenti
	DROP Via;
```

```SQL
CREATE UNIQUE INDEX IndicePerNome
	ON Impiegati (cognome, nome)

DROP INDEX IndicePerNome ON Impiegati
```

```SQL
INSERT INTO Impiegati 
  (nome, cognome, stipendio, id_dipartimento)
  VALUES
  ('Giovanni', 'Pandolfo', 1000, 10 )

```

```SQL
SELECT * FROM Impiegati;
```

```SQL
UPDATE Impiegati 
SET stipendio = 100.11
WHERE nome = 'Pietro';

SELECT nome, stipendio 
	FROM Impiegati 
    WHERE nome = 'Pietro';
```

```SQL
INSERT INTO Impiegati
  (nome, cognome, residenza, stipendio, id_dipartimento)
VALUES
  ('Giulia', 'Verdi', 'Torino', 1500.50, 1)
```

## Comandi importanti

**ALTER TABLE**, data una tabella, ne altera i vincoli e i campi.

**UPDATE**, data una riga, permette di modificare i dati salvati.
```SQL
UPDATE Impiegati 
SET stipendio = NULL
WHERE nome = 'Giulia'
```

**ALL** e **DISTINCT**, permettono di mantenere o eliminare i dati duplicati.

```SQL
SELECT ALL nome,cognome FROM Impiegati WHERE nome = 'Giulia';

SELECT DISTINCT nome,cognome FROM Impiegati WHERE nome = 'Giulia';
```

**AS**, si usa per rinominare una colonna

```SQL
SELECT nome AS soprannome FROM Impiegati;

SELECT nome AS soprannome, stipendio AS netto, stipendio * 1.22 AS lordo, (stipendio * 1.22) - stipendio AS tasse FROM Impiegati;

```


**NULL** nella ricerca
```SQL
WHERE stipendio = NULL  -- Non funziona
WHERE stipendio IS NULL -- Funziona
```

Nella select, il primo parametro è usato per la proiezione, il secondo per la join, il testo per la selezione

